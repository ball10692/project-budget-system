<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ</title>
  <meta name="description" content="‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ ‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£">
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <!-- ===== NOTIFICATION TOAST ===== -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- ADD USER MODAL -->
  <div class="modal-overlay" id="userModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="userModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</div>
        <button class="modal-close" onclick="closeUserModal()">‚úï</button>
      </div>

      <form id="userForm" onsubmit="event.preventDefault();saveUser()">
        <input type="hidden" id="fUserId">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label required">Username</label>
            <input type="text" id="fUserUsername" placeholder="‡πÄ‡∏ä‡πà‡∏ô admin.afdc" required>
          </div>
          <div class="form-group">
            <label class="form-label required">Password</label>
            <input type="text" id="fUserPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
          </div>
          <div class="form-group">
            <label class="form-label required">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Role)</label>
            <select id="fUserRole" onchange="handleUserRoleChange()" required>
              <option value="user">User (‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏†‡∏≤‡∏Ñ)</option>
              <option value="super user">Super User (‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏Ñ ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ)</option>
              <option value="admin">Admin (‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label required">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• / ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
            <input type="text" id="fUserName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏û.‡∏ó. ‡πÄ‡∏à‡∏£‡∏¥‡∏ç" required>
          </div>
          <div class="form-group">
            <label class="form-label required" id="labelUserResponsibility">‡∏†‡∏≤‡∏Ñ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
            <select id="fUserResponsibility">
              <option value="‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏Ñ">‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏Ñ (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á)</option>
            </select>
          </div>
        </div>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:20px">
          <button type="button" class="btn btn-outline" onclick="closeUserModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
        </div>
      </form>
    </div>
  </div>


  <!-- ===== HEADER ===== -->
  <header class="app-header">
    <div class="header-inner">
      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="‡πÄ‡∏°‡∏ô‡∏π">
        ‚ò∞
      </button>
      <div class="logo">
        <div class="logo-icon">üèõÔ∏è</div>
        <div class="logo-text">
          <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ</h1>
          <p>Project Budget Management System</p>
        </div>
      </div>
      <div class="header-date" id="headerDate">‚Äî</div>
      <div class="user-info-display" id="headerUserInfo" style="display:none">
        <div class="user-avatar" id="headerUserAvatar">A</div>
        <div class="user-details">
          <span class="user-name" id="headerUserName">Admin</span>
          <span class="user-role" id="headerUserRole">Administrator</span>
        </div>
        <button class="btn btn-outline btn-sm" onclick="handleLogout()" style="margin-left: 10px; padding: 4px 8px;"
          title="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö">
          üö™ Logout
        </button>
      </div>

    </div>
  </header>

  <!-- ===== NAVIGATION ===== -->
  <nav class="nav-tabs">
    <button class="nav-tab active" data-tab="dashboard">
      <span class="tab-icon">üìä</span> ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å / Dashboard
    </button>
    <button class="nav-tab" data-tab="projects">
      <span class="tab-icon">üìã</span> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
    </button>
    <button class="nav-tab" data-tab="review">
      <span class="tab-icon">üîç</span> ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
    </button>
    <button class="nav-tab" data-tab="report">
      <span class="tab-icon">üìÑ</span> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ
    </button>
    <button class="nav-tab" data-tab="dbmanage">
      <span class="tab-icon">üóÑÔ∏è</span> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    </button>
    <button class="nav-tab" data-tab="users">
      <span class="tab-icon">üë•</span> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
    </button>
  </nav>

  <!-- ===== MAIN CONTENT ===== -->
  <main class="main-content">

    <!-- ========== PAGE 1: DASHBOARD ========== -->
    <div class="page active" id="page-dashboard">
      <div class="page-header" style="display:flex;justify-content:space-between;align-items:center">
        <div class="page-title">
          <div class="page-title-icon"
            style="background:linear-gradient(135deg,rgba(59,130,246,0.2),rgba(6,182,212,0.1))">üìä</div>
          <div>
            <h2>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
            <p>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
          </div>
        </div>

      </div>

      <!-- Filters -->
      <div class="filter-bar">
        <span class="filter-label">üîΩ ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</span>
        <select id="dashAgencyFilter" style="width:auto;min-width:180px">
          <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</option>
        </select>
        <select id="dashTypeFilter" style="width:auto;min-width:220px">
          <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</option>
        </select>
      </div>

      <!-- Stat Cards -->
      <div class="stats-grid" style="grid-template-columns:repeat(auto-fit,minmax(180px,1fr))">
        <div class="stat-card" style="border-color:rgba(59,130,246,0.3)">
          <div class="stat-icon">üìÅ</div>
          <div class="stat-value" id="statTotal" style="color:#60a5fa">0</div>
          <div class="stat-label">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
        </div>
        <div class="stat-card" style="border-color:rgba(6,182,212,0.3)">
          <div class="stat-icon">üí∞</div>
          <div class="stat-value" id="statBudget" style="color:#22d3ee;font-size:22px">0</div>
          <div class="stat-label">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</div>
        </div>
        <div class="stat-card" style="border-color:rgba(245,158,11,0.3)">
          <div class="stat-icon">üîç</div>
          <div class="stat-value" id="statReviewed" style="color:#fbbf24">0</div>
          <div class="stat-label">‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß</div>
        </div>
        <div class="stat-card" style="border-color:rgba(16,185,129,0.3)">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-value" id="statPassed" style="color:#34d399">0</div>
          <div class="stat-label">‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)</div>
        </div>
      </div>

      <!-- Type Breakdown -->
      <div class="section-title">üìå ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</div>
      <div class="stats-grid" id="typeBreakdownGrid"></div>

      <!-- Status Chart + Agency Table -->
      <div style="display:grid;grid-template-columns:1fr 2fr;gap:20px;margin-top:8px" class="dashboard-bottom">
        <div class="card">
          <div class="card-title">üéØ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</div>
          <div id="statusDonut"></div>
        </div>
        <div class="card">
          <div class="card-title">üè¢ ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ</th>
                  <th style="text-align:center">‡∏£‡∏ß‡∏°</th>
                  <th style="text-align:center">üõ£Ô∏è ‡∏Ñ‡∏°‡∏ô‡∏≤‡∏Ñ‡∏°</th>
                  <th style="text-align:center">üíß ‡∏ô‡πâ‡∏≥</th>
                  <th style="text-align:center">üèòÔ∏è ‡∏û‡∏±‡∏í‡∏ô‡∏≤</th>
                  <th style="text-align:center">üåæ ‡πÄ‡∏Å‡∏©‡∏ï‡∏£</th>
                  <th>‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏ß‡∏°</th>
                </tr>
              </thead>
              <tbody id="agencyTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- ========== PAGE 2: PROJECTS ========== -->
    <div class="page" id="page-projects">
      <div class="page-header">
        <div class="page-title">
          <div class="page-title-icon"
            style="background:linear-gradient(135deg,rgba(245,158,11,0.2),rgba(249,115,22,0.1))">üìã</div>
          <div>
            <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
            <p>‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</p>
          </div>
        </div>
        <div class="btn-group" style="align-items:center">
          <div
            style="display:flex;align-items:center;gap:6px;background:var(--bg-card);padding:6px 12px;border-radius:var(--radius);border:1px solid var(--border)">
            <label style="font-weight:600;font-size:13px;white-space:nowrap">üìÖ ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</label>
            <select id="fiscalYearSelect" class="form-control"
              style="width:auto;min-width:110px;padding:6px 8px;font-size:13px"></select>
          </div>
          <button class="btn btn-outline" onclick="downloadTemplateWithFY()">
            üì• Template Excel
          </button>
          <button class="btn btn-warning" onclick="importWithFY()">
            üì§ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Excel
          </button>
          <input type="file" id="importFileInput" accept=".xlsx,.xls" style="display:none"
            onchange="handleImportExcel(event)">
          <button class="btn btn-outline" style="border-color:var(--accent-red);color:var(--accent-red)"
            onclick="clearAllProjects()">
            üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
          </button>
          <button class="btn btn-primary" onclick="openProjectModal()">
            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
          </button>
        </div>
      </div>

      <!-- Filters for Projects Page -->
      <div class="filter-bar">
        <div class="filter-group">
          <span class="filter-label">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</span>
          <input type="text" id="projectSearch" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£..." style="width:auto;min-width:200px">
        </div>

        <div class="filter-group">
          <span class="filter-label">üìÖ ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</span>
          <select id="projectFiscalYearFilter" style="width:auto;min-width:130px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üìÅ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô:</span>
          <select id="projectTypeFilter" style="width:auto;min-width:160px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üè¢ ‡∏Å‡∏£‡∏≠‡∏á:</span>
          <select id="projectAgencyFilter" style="width:auto;min-width:180px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ</option>
          </select>
          <select id="projectUnitFilter" style="width:auto;min-width:150px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üí∞ ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</span>
          <select id="projectBudgetTypeFilter" style="width:auto;min-width:160px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏ö</option>
          </select>
        </div>
      </div>

      <div class="card" style="padding:0">
        <div class="table-wrapper">
          <div style="padding:10px;display:none;background:rgba(239,68,68,0.1);border-bottom:1px solid var(--border)"
            id="bulkActionHeader">
            <button class="btn btn-danger btn-sm" onclick="deleteSelectedProjects()">
              üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (<span id="selectedCount">0</span>)
            </button>
          </div>
          <table>
            <thead>
              <tr>
                <th style="width:40px;text-align:center"><input type="checkbox" id="selectAllProjects"
                    onchange="toggleSelectAll()"></th>
                <th>‡∏£‡∏´‡∏±‡∏™</th>
                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏°‡∏¥‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</th>
                <th>‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                <th>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì</th>
                <th>‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</th>
                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏ö</th>
                <th>‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ / ‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
              </tr>
            </thead>
            <tbody id="projectsTableBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ========== PAGE 3: REVIEW ========== -->
    <div class="page" id="page-review">
      <div class="page-header">
        <div class="page-title">
          <div class="page-title-icon"
            style="background:linear-gradient(135deg,rgba(139,92,246,0.2),rgba(59,130,246,0.1))">üîç</div>
          <div>
            <h2>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
            <p>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£</p>
          </div>
        </div>
        <button class="btn btn-success btn-lg" onclick="saveAllReviews()">
          üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </button>
      </div>

      <!-- Filters for Review Page -->
      <div class="filter-bar">
        <div class="filter-group">
          <span class="filter-label">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</span>
          <input type="text" id="reviewSearch" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£..." style="width:auto;min-width:200px">
        </div>

        <div class="filter-group">
          <span class="filter-label">üìÖ ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</span>
          <select id="reviewFiscalYearFilter" style="width:auto;min-width:130px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üìÅ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô:</span>
          <select id="reviewTypeFilter" style="width:auto;min-width:160px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üè¢ ‡∏Å‡∏£‡∏≠‡∏á:</span>
          <select id="reviewAgencyFilter" style="width:auto;min-width:180px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ</option>
          </select>
          <select id="reviewUnitFilter" style="width:auto;min-width:150px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üí∞ ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</span>
          <select id="reviewBudgetTypeFilter" style="width:auto;min-width:160px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏ö</option>
          </select>
        </div>

        <div class="filter-group">
          <span class="filter-label">üéØ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
          <select id="reviewStatusFilter" style="width:auto;min-width:160px">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
          </select>
        </div>
      </div>

      <!-- Status Legend -->
      <div class="filter-bar" style="margin-bottom:20px">
        <span class="filter-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
        <span class="badge badge-gray">‚è≥ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</span>
        <span class="badge badge-green">üü¢ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß = ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</span>
        <span class="badge badge-yellow">üü° ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£</span>
        <span class="badge badge-yellow">üü°‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</span>
        <span class="badge badge-yellow">üü° ‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</span>
        <span class="badge badge-red">üî¥ ‡πÅ‡∏î‡∏á = ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</span>
      </div>

      <div id="reviewContainer"></div>
    </div>

    <!-- ========== PAGE 4: REPORT ========== -->
    <div class="page" id="page-report">
      <div class="page-header">
        <div class="page-title">
          <div class="page-title-icon"
            style="background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(6,182,212,0.1))">üìÑ</div>
          <div>
            <h2>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
            <p>‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</p>
          </div>
        </div>
      </div>

      <div class="card" style="margin-bottom:20px">
        <div
          style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:15px">
          <div class="card-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
          <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
            <select id="reportFiscalYearFilter" class="form-control" style="width:160px">
              <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
            </select>
            <select id="reportAgencyFilter" class="form-control" style="width:200px">
              <option value="">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
            </select>
            <select id="reportUnitFilter" class="form-control" style="width:200px">
              <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢</option>
            </select>
            <select id="reportRoundFilter" class="form-control" style="width:180px">
              <option value="">‡∏ó‡∏∏‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</option>
            </select>
            <button class="btn btn-success" onclick="exportReport()">
              üìä Export Excel
            </button>
          </div>
        </div>
      </div>

      <!-- Report Preview -->
      <div class="report-preview">
        <div
          style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:12px">
          <div>
            <div style="font-size:18px;font-weight:700" id="reportTitle">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            <div style="font-size:13px;color:var(--text-muted);margin-top:4px">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô Export</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:13px;color:var(--text-muted)">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</div>
            <div style="font-size:20px;font-weight:700;color:var(--accent-blue)" id="reportTotal">‚Äî</div>
            <div style="font-size:13px;color:var(--text-muted);margin-top:4px">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏ß‡∏°</div>
            <div style="font-size:18px;font-weight:700;color:var(--accent-cyan)" id="reportBudget">‚Äî</div>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;flex-wrap:wrap">
          <div>
            <div class="section-title" style="font-size:14px">üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</div>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</th>
                    <th style="text-align:center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                    <th>‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</th>
                  </tr>
                </thead>
                <tbody id="reportTypeSummary"></tbody>
              </table>
            </div>
          </div>
          <div>
            <div class="section-title" style="font-size:14px">üéØ ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</div>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    <th style="text-align:center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                    <th>‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</th>
                  </tr>
                </thead>
                <tbody id="reportStatusSummary"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ========== PAGE 5: DATABASE MANAGEMENT ========== -->
    <div class="page" id="page-dbmanage">
      <div class="page-header">
        <div class="page-title">
          <div class="page-title-icon"
            style="background:linear-gradient(135deg,rgba(99,102,241,0.2),rgba(139,92,246,0.1))">üóÑÔ∏è</div>
          <div>
            <h2>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
            <p>‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏•‡∏ö ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</p>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn btn-outline" onclick="downloadDbTemplate()">
            üì• Download DB Template
          </button>
          <button class="btn btn-warning" onclick="document.getElementById('importDbFileInput').click()">
            üì§ Upload DB Excel
          </button>
          <input type="file" id="importDbFileInput" accept=".xlsx,.xls" style="display:none"
            onchange="handleImportDbExcel(event)">
          <button class="btn btn-outline" onclick="resetDbDefaults()">
            üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
          </button>
        </div>
      </div>

      <div class="db-manage-container">
        <!-- Left: Project Types -->
        <div class="db-panel">
          <div class="db-panel-header">
            <h3>üìÅ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h3>
            <button class="btn btn-primary btn-sm" onclick="showAddTypeForm()">
              ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
            </button>
          </div>
          <div id="addTypeForm" class="db-add-form" style="display:none">
            <div class="form-grid" style="grid-template-columns:80px 1fr 100px">
              <input type="text" id="newTypeId" placeholder="‡∏£‡∏´‡∏±‡∏™" maxlength="4" style="text-align:center">
              <input type="text" id="newTypeLabel" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£">
              <input type="color" id="newTypeColor" value="#6366f1" title="‡∏™‡∏µ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó">
            </div>
            <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end">
              <button class="btn btn-outline btn-sm" onclick="hideAddTypeForm()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
              <button class="btn btn-primary btn-sm" onclick="confirmAddType()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
          </div>
          <div id="typeList" class="db-item-list"></div>
        </div>

        <!-- Right: Sub-Items -->
        <div class="db-panel">
          <div class="db-panel-header">
            <h3 id="subItemTitle">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢</h3>
            <button class="btn btn-primary btn-sm" id="addSubItemBtn" onclick="showAddSubItemForm()"
              style="display:none">
              ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢
            </button>
          </div>
          <div id="addSubItemForm" class="db-add-form" style="display:none">
            <div class="form-grid" style="grid-template-columns:1fr">
              <input type="text" id="newSubItemName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢">
            </div>
            <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end">
              <button class="btn btn-outline btn-sm" onclick="hideAddSubItemForm()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
              <button class="btn btn-primary btn-sm" onclick="confirmAddSubItem()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
          </div>
          <div id="subItemList" class="db-item-list">
            <div class="empty-state" style="padding:40px">
              <div class="empty-icon">üëà</div>
              <h3>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h3>
              <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Second row: Regional Offices + Units -->
      <h3 style="margin-top:24px;margin-bottom:12px;color:var(--text-secondary)">üè¢ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢</h3>
      <div class="db-manage-container">
        <!-- Left: Regional Offices -->
        <div class="db-panel">
          <div class="db-panel-header">
            <h3>üè¢ ‡∏†‡∏≤‡∏Ñ (‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ)</h3>
            <button class="btn btn-primary btn-sm" onclick="showAddOfficeForm()">
              ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏Ñ
            </button>
          </div>
          <div id="addOfficeForm" class="db-add-form" style="display:none">
            <div class="form-grid" style="grid-template-columns:1fr">
              <input type="text" id="newOfficeName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏Ñ ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ 6">
            </div>
            <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end">
              <button class="btn btn-outline btn-sm" onclick="hideAddOfficeForm()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
              <button class="btn btn-primary btn-sm" onclick="confirmAddOffice()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
          </div>
          <div id="officeList" class="db-item-list"></div>
        </div>

        <!-- Right: Units -->
        <div class="db-panel">
          <div class="db-panel-header">
            <h3 id="unitTitle">üìã ‡∏´‡∏ô‡πà‡∏ß‡∏¢</h3>
            <button class="btn btn-primary btn-sm" id="addUnitBtn" onclick="showAddUnitForm()" style="display:none">
              ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢
            </button>
          </div>
          <div id="addUnitForm" class="db-add-form" style="display:none">
            <div class="form-grid" style="grid-template-columns:1fr">
              <input type="text" id="newUnitName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≠‡∏á‡∏û‡∏±‡∏ô ‡∏ó‡∏û.14">
            </div>
            <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end">
              <button class="btn btn-outline btn-sm" onclick="hideAddUnitForm()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
              <button class="btn btn-primary btn-sm" onclick="confirmAddUnit()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
          </div>
          <div id="unitList" class="db-item-list">
            <div class="empty-state" style="padding:40px">
              <div class="empty-icon">üëà</div>
              <h3>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ</h3>
              <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏ß‡∏¢</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ========== PAGE 6: USERS ========== -->
    <div class="page" id="page-users">
      <div class="page-header" style="display:flex;justify-content:space-between;align-items:center">
        <div class="page-title">
          <div class="page-title-icon"
            style="background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(59,130,246,0.1))">üë•</div>
          <div>
            <h2>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
            <p>‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏•‡∏ö ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
          </div>
        </div>
        <button class="btn btn-primary" onclick="openUserModal()">+ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
      </div>

      <div class="card" style="padding: 0; overflow: hidden;">
        <div class="table-wrapper" style="border: none;">
          <table id="usersTable">
            <thead>
              <tr>
                <th>Username</th>
                <th>‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÇ‡∏î‡∏¢</th>
                <th>Role (‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå)</th>
                <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</th>
                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</th>
                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
              </tr>
            </thead>
            <tbody>
              <!-- Users will be rendered here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </main>

  <!-- ===== ADD PROJECT MODAL ===== -->
  <div class="modal-overlay" id="projectModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</div>
        <button class="modal-close" onclick="closeProjectModal()">‚úï</button>
      </div>

      <form id="projectForm" onsubmit="event.preventDefault();saveProject()">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label required">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏û.‡∏®.)</label>
            <select id="fFiscalYear"></select>
          </div>
          <div class="form-group">
            <label class="form-label required">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
            <select id="fType"></select>
          </div>
          <div class="form-group" style="grid-column:1/-1">
            <label class="form-label required">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢</label>
            <select id="fSubItem">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢ --</option>
            </select>
          </div>
          <div class="form-group" style="grid-column:1/-1;display:none" id="fSubItemCustomGroup">
            <label class="form-label">‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢ (‡∏Å‡∏£‡∏ì‡∏µ‡∏≠‡∏∑‡πà‡∏ô‡πÜ)</label>
            <input type="text" id="fSubItemCustom" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢">
          </div>
          <div class="form-group" style="grid-column:1/-1">
            <label class="form-label">‡∏°‡∏¥‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</label>
            <input type="text" id="fDimension" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏ß‡πâ‡∏≤‡∏á 6 ‡∏°. ‡∏¢‡∏≤‡∏ß 1,000 ‡∏°.">
          </div>

          <div class="form-group">
            <label class="form-label">‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà</label>
            <input type="text" id="fMoo" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3">
          </div>
          <div class="form-group">
            <label class="form-label">‡∏ö‡πâ‡∏≤‡∏ô</label>
            <input type="text" id="fVillage" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô">
          </div>
          <div class="form-group">
            <label class="form-label">‡∏ï‡∏≥‡∏ö‡∏•</label>
            <input type="text" id="fTambon" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡∏ö‡∏•">
          </div>
          <div class="form-group">
            <label class="form-label">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
            <input type="text" id="fAmphoe" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
          </div>
          <div class="form-group">
            <label class="form-label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
            <input type="text" id="fProvince" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
          </div>

          <div class="form-group">
            <label class="form-label required">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏á‡∏≤‡∏ô</label>
            <input type="number" id="fQuantity" placeholder="0" min="0" step="0.001">
          </div>
          <div class="form-group">
            <label class="form-label required">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö</label>
            <input type="text" id="fUnit" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏°‡∏ï‡∏£, ‡∏£‡∏∞‡∏ö‡∏ö, ‡∏Ñ‡∏ô">
          </div>
          <div class="form-group">
            <label class="form-label required">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏ö‡∏≤‡∏ó)</label>
            <input type="number" id="fBudget" placeholder="0" min="0">
          </div>
          <div class="form-group">
            <label class="form-label required">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
            <select id="fBudgetType"></select>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ</label>
            <select id="fRegionalOffice"></select>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö)</label>
            <select id="fUnitOrg">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢ --</option>
            </select>
          </div>
        </div>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:8px">
          <button type="button" class="btn btn-outline" onclick="closeProjectModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== TOAST CONTAINER ===== -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- ===== SCRIPTS ===== -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
  <script src="data.js"></script>
  <script src="excel-utils.js"></script>
  <script src="app.js"></script>

  <!-- Responsive dashboard grid fix -->
  <style>
    @media (max-width: 900px) {
      .dashboard-bottom {
        grid-template-columns: 1fr !important;
      }

      #page-report .report-preview>div:last-child {
        grid-template-columns: 1fr !important;
      }
    }
  </style>

</body>

</html>